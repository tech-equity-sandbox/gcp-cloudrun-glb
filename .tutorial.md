## Getting started

Depending on the platform setup, the asset may initialize automatically or may need to be manually executed. To manually execute the asset, run the command `./gcp-cloudrun-glb.sh` on the terminal.

When you run the script, it sets up the pre-requisite automation tools behind the scenes. 

Please be patient, and allow a few seconds for the lab to initialize. 

You will be promted to enter any key to continue once the initialization process is complete.
There are 3 modes of operation. 

Change the mode by selecting step `m`, and enter your preference by selecting an option from the list below:

- `y` to preview configuration or commands.
- `n` to execute commands in the create mode.
- `d` to delete resources in the delete mode.

Enter any key to return to the menu, and click the **START** button below.

## Selecting a project

You need to select a project to deploy the resources required for this lab.

*Hint: You should be the Owner or Editor of this project. We recommend deleting the project at the end of the lab to avoid incurring additional costs.*

Change the mode by selecting step `m`, and select the create mode by entering `n` at the prompt.

If prompted for a code, enter a valid code. For help, contact `support@techequity.cloud`.

Click the **NEXT** button to continue.

## Sign in

You need to authenticate to `gcloud` to complete the lab.

When prompted to authenticate, enter `y`, click the link displayed, sign-in using your Google Cloud account, and click the `Allow` button to grant permissions to Google Cloud SDK. 

Click the `Copy` button to copy the authorization code. 

Return to the cloud shell terminal and paste the authorization code into the prompt to authenticate to cloud shell.

When prompted to change the project from `NOT_SET`, enter `y` and enter your project ID. 

Enter any key at the `$` prompt to return to the menu, and click the **NEXT** button to continue.


## Explore Cloud Run Features

This asset enables you to explore traffic management capabilities on Cloud Run fully managed platform. 

You can use this asset to learn how to configure access to a Cloud Run service via the Google Cloud Global Load Balancer. 

The Google Cloud Load Balancer scenarios demonstrate integration with Cloud Armor to restrict access to the service, as well as integration with Cloud CDN to cache static content at the edge of the network.

**Time to complete**: About 30 minutes

**Prerequisites**: You need Project Owner or Editor Role.

### Outline

This asset enables you to perform the following activities:

- Enable APIs
- Explore revision based traffic routing 
- Explore tag based traffic routing 
- Configure access via Global Load Balancer 
- Restrict access with Cloud Armor 
- Cache requests using Cloud CDN 

## Step 0: Launch step by step guide

Use this option to launch an interactive step by step guide. 

If new to this experience, follow the guide carefully. 

As your experience grows, the need to refer to this guide will diminish, as the lab experience is designed to be intuitive.

## Step 1: Enable APIs

You need to enable the APIs in the project to perform the required tasks. 

You only need to do this once for your project. 

Enter `1` at the additional steps to perform prompt to enable the API.  

Note the list of APIs enabled.

To deploy a sample service and explore revision based traffic routing, click **NEXT** 

## Step 2 Explore revision based traffic routing

Enter `2` at the additional steps to explore revision based traffic routing.

Review the commands and options.

Navigate to `https://console.cloud.google.com/run?project={{project-id}}` and explore traffic management capabilities on the Google Cloud console.

Enter any key at the `$` prompt to return to the menu. Click **NEXT**

## Step 3: Explore tag based traffic routing

Enter `3` at the additional steps to explore tag based traffic routing.

Review the commands and options.

Navigate to `https://console.cloud.google.com/run?project={{project-id}}` and explore traffic management capabilities on the Google Cloud console.

Enter any key at the `$` prompt to return to the menu. Click **NEXT**

## Step 4: Configure access via the Global Load Balancer

Enter `4` at the additional steps to explore Google Cloud Global Load Balancer configuration.

Review the commands and options.

Navigate to `https://console.cloud.google.com/run?project={{project-id}}` and explore traffic management capabilities on the Google Cloud console.

Navigate to `https://console.cloud.google.com/net-services/loadbalancing/list/loadBalancers?authuser=3&project={{project-id}}` and explore load balancer on the Google Cloud console.

Enter any key at the `$` prompt to return to the menu. Click **NEXT**

## Step 5: Secure access via the Global Load Balancer with Cloud Armor

Enter `5` at the additional steps to explore Google Cloud Global Load Balancer configuration with Cloud Armor integration.

Review the commands and options.

Navigate to `https://console.cloud.google.com/run?project={{project-id}}` and explore traffic management capabilities on the Google Cloud console.

Navigate to `https://console.cloud.google.com/net-services/loadbalancing/list/loadBalancers?authuser=3&project={{project-id}}` and explore load balancer on the Google Cloud console.

Enter any key at the `$` prompt to return to the menu. Click **NEXT**

## Step 6: Cache static content served via the Global Load Balancer with Cloud CDN

Enter `6` at the additional steps to explore Google Cloud Global Load Balancer configuration with Cloud CDN integration.

Review the commands and options.

Navigate to `https://console.cloud.google.com/run?project={{project-id}}` and explore traffic management capabilities on the Google Cloud console.

Navigate to `https://console.cloud.google.com/net-services/loadbalancing/list/loadBalancers?authuser=3&project={{project-id}}` and explore load balancer on the Google Cloud console.

Congratulations! You have completed the setup.